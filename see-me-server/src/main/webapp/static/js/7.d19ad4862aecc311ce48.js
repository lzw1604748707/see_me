webpackJsonp([7],{"1N5e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("aA9S"),a=i.n(o),n=i("E4C3"),r=i.n(n),s=i("OMN4"),l=i.n(s).a.create();var c=i("eOoE");var d={data:function(){return{query:{title:""},addEditDialogVisible:!1,dialogImgVisible:!1,dialogImageUrl:"",isEdit:!1,page:{pageNumber:1,pageSize:10,total:1},cover:"",extCoverList:[],schoolList:[],schoolIdList:[],infoForm:{cover:"",extCoverList:[],schoolIdList:[],content:"",area:""},rules:{title:[{required:!0,message:"請輸入學校名稱",trigger:"blur"}],cover:[{required:!0,message:"請上傳封面",trigger:"change"}],area:[{required:!0,message:"請選擇推送範圍",trigger:"change"}],content:[{required:!0,message:"請輸入正文",trigger:"blur"},{min:20,message:"長度不能少於20個字符",trigger:"blur"}]},tableData:[]}},created:function(){},mounted:function(){this.getList()},computed:{headers:function(){return{jxtAdminSessionId:this.$store.state.token}}},methods:{handleSizeChange:function(e){this.page.pageSize=e,this.getList()},handleCoverCardPreview:function(e){this.dialogImageUrl=e,this.dialogImgVisible=!0},handleCurrentChange:function(e){this.pageNumber=e,this.getList()},formatDateJoinAt:function(e,t){return this.$moment(e.joinAt).format("YYYY-MM-DD")},formatDateNextPayAt:function(e,t){return this.$moment(e.nextPayAt).format("YYYY-MM-DD")},handleSearch:function(){this.getList()},handleAdd:function(){this.isEdit=!1,this.cover="",this.extCoverList=[],this.infoForm=a()({},null),this.addEditDialogVisible=!0},handleEdit:function(e,t){var i=this;this.cover="",this.extCoverList=[],this.isEdit=!0,this.infoForm=a()({},t),this.cover=this.infoForm.cover,this.infoForm.schoolIdList=t.schoolIdList,this.infoForm.extCoverList.forEach(function(e){var t={url:e.url};i.extCoverList.push(t)}),this.getSchoolList(0),this.addEditDialogVisible=!0},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogImgVisible=!0},handleExtCoverSuccess:function(e,t){this.extCoverList.push(e.file),this.infoForm.extCoverList=this.extCoverList},handleExtCoverRemove:function(e,t){this.infoForm.extCoverList=this.extCoverList},handleCoverRemove:function(e,t){this.infoForm.cover=""},handleCoverSuccess:function(e,t){this.cover=e.file.url,this.infoForm.cover=e.file.url},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png",i=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),i||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&i},handleImageAdded:function(e,t,i){(function(e,t,i){var o=new FormData;o.append("file",e);var a={headers:{"Content-Type":"multipart/form-data",jxt_admin_session_id:i}};return l.post(t,o,a)})(e,"/admin/upload").then(function(e){var o=e.data.file.url;-1===o.indexOf("http")&&(o="http://127.0.0.1:80"+o),t.insertEmbed(i,"image",o)}).catch(function(e){console.log(e)})},handleSubmitSave:function(){var e=this;this.$refs.infoForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start(),e.infoForm.schoolIdList=e.schoolIdList;var t,i=a()({},e.infoForm);(t=i,Object(c.a)({url:"/admin/info/information/save",method:"post",data:t})).then(function(t){r.a.done(),e.$message.success(t.data.msg),e.$refs.infoForm.resetFields(),e.addEditDialogVisible=!1,e.getList()})})})},handleSubmitUpdate:function(){var e=this;this.$refs.infoForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start();var t,i=a()({},e.infoForm);(t=i,Object(c.a)({url:"/admin/info/information/update",method:"post",data:t})).then(function(t){r.a.done(),e.$message.success(t.data.msg),e.$refs.infoForm.resetFields(),e.addEditDialogVisible=!1,e.getList()})})})},handleRemove:function(e,t){var i=this;this.$confirm("確定刪除嗎？").then(function(e){(function(e){return Object(c.a)({url:"/admin/info/information/remove/"+e,method:"get"})})(t.id).then(function(e){i.$message.success(e.data.msg),i.getList()}).catch(function(e){i.$message.error(e)})}).catch(function(e){})},handleDownShelf:function(e,t){var i=this;this.$confirm("確定下架嗎？").then(function(e){(function(e){return Object(c.a)({url:"/admin/info/information/downShelf/"+e,method:"get"})})(t.id).then(function(e){i.infoForm.status=!1,i.getList(),i.$message.success(e.data.msg)}).catch(function(e){i.$message.error(e)})}).catch(function(e){})},getList:function(){var e=this;(function(e){return Object(c.a)({url:"/admin/info/information/list",method:"post",data:e})})({title:this.query.title,pageNumber:this.page.pageNumber,pageSize:this.page.pageSize}).then(function(t){e.tableData=t.data.page.list,e.page.pageNumber=t.data.page.pageNumber,e.page.pageSize=t.data.page.pageSize,e.page.total=t.data.page.totalRow}).catch(function(t){e.$message.error(t),console.log(t)})},getSchoolList:function(e){var t=this;(function(e){return Object(c.a)({url:"/admin/info/information/getSchoolList/",method:"post",data:e})})({area:e}).then(function(e){t.schoolList=e.data.list}).catch(function(e){t.$message.error(e),console.log(e)})}}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{staticClass:"query-form",attrs:{inline:"",model:e.query,"label-position":"right","label-width":"70px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"請輸入資訊名稱"},model:{value:e.query.title,callback:function(t){e.$set(e.query,"title",t)},expression:"query.title"}}),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("添加資訊")])],1)],1),e._v(" "),i("el-table",{staticClass:"table",attrs:{data:e.tableData,stripe:"",border:""}},[i("el-table-column",{attrs:{type:"index",label:"序號",width:"70"}}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"名稱"}}),e._v(" "),i("el-table-column",{attrs:{prop:"cover",label:"封面圖",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("img",{staticStyle:{width:"30px",height:"30px",cursor:"pointer"},attrs:{src:t.row.cover},on:{click:function(i){e.handleCoverCardPreview(t.row.cover)}}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"accountName",label:"資訊發佈人"}}),e._v(" "),i("el-table-column",{attrs:{prop:"readCount",label:"閱讀量"}}),e._v(" "),i("el-table-column",{attrs:{prop:"account",label:"操作人"}}),e._v(" "),i("el-table-column",{attrs:{prop:"status",label:"狀態"},scopedSlots:e._u([{key:"default",fn:function(t){return[!0===t.row.status?i("span",[e._v("上架")]):i("span",[e._v("下架")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(i){e.handleDownShelf(t.$index,t.row)}}},[e._v("下架")]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleEdit(t.$index,t.row)}}},[e._v("編輯")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.handleRemove(t.$index,t.row)}}},[e._v("刪除")])]}}])})],1),e._v(" "),i("el-pagination",{attrs:{"current-page":e.page.pageNumber,"page-sizes":[10,20,30,40],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("el-dialog",{attrs:{title:"新增/编辑",visible:e.addEditDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addEditDialogVisible=t}}},[i("el-form",{ref:"infoForm",attrs:{model:e.infoForm,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"title",label:"標題："}},[i("el-input",{model:{value:e.infoForm.title,callback:function(t){e.$set(e.infoForm,"title",t)},expression:"infoForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"cover",label:"封面："}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/admin/upload",headers:e.headers,"show-file-list":!1,"on-success":e.handleCoverSuccess,"on-remove":e.handleCoverRemove,"before-upload":e.beforeAvatarUpload}},[e.cover?i("img",{staticClass:"avatar",attrs:{src:e.cover}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),i("el-form-item",{attrs:{prop:"extCover",label:"配圖："}},[i("el-upload",{attrs:{action:"/admin/upload","list-type":"picture-card",headers:e.headers,"file-list":e.extCoverList,"on-success":e.handleExtCoverSuccess,"on-remove":e.handleExtCoverRemove,"on-preview":e.handlePictureCardPreview,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),i("el-form-item",{attrs:{prop:"schoolIdList",label:"範圍："}},[!1===e.isEdit?i("el-select",{attrs:{placeholder:"請選擇區域"},on:{change:e.getSchoolList},model:{value:e.infoForm.area,callback:function(t){e.$set(e.infoForm,"area",t)},expression:"infoForm.area"}},[i("el-option",{key:"0",attrs:{label:"全部",value:"0"}}),e._v(" "),i("el-option",{key:"1",attrs:{label:"澳門",value:"澳門"}}),e._v(" "),i("el-option",{key:"2",attrs:{label:"珠海",value:"珠海"}}),e._v(" "),i("el-option",{key:"3",attrs:{label:"香港",value:"香港"}})],1):e._e(),e._v(" "),i("el-select",{attrs:{disabled:e.isEdit,multiple:"",placeholder:"請選擇學校"},model:{value:e.schoolIdList,callback:function(t){e.schoolIdList=t},expression:"schoolIdList"}},[i("el-option",{key:"0",attrs:{label:"全部",value:"0"}}),e._v(" "),e._l(e.schoolList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),i("el-form-item",{attrs:{prop:"content",label:"正文"}},[i("vue-editor",{attrs:{useCustomImageHandler:""},on:{imageAdded:e.handleImageAdded},model:{value:e.infoForm.content,callback:function(t){e.$set(e.infoForm,"content",t)},expression:"infoForm.content"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addEditDialogVisible=!1}}},[e._v("關閉")]),e._v(" "),e.isEdit?i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitUpdate}},[e._v("提 交")]):i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitSave}},[e._v("確 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogImgVisible,size:"tiny"},on:{"update:visible":function(t){e.dialogImgVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[]};var m=i("Z0/y")(d,u,!1,function(e){i("Ht1G")},null,null);t.default=m.exports},Ht1G:function(e,t,i){var o=i("xIdC");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i("FIqI")("6371fe24",o,!0,{})},xIdC:function(e,t,i){(e.exports=i("XLS9")(!0)).push([e.i,"\n.school-item {\r\n  margin-bottom: 1px;\n}\n.school-name {\r\n  font-weight: 700;\n}\r\n","",{version:3,sources:["E:/See-me/admin-web/src/views/info/InfoList.vue"],names:[],mappings:";AACA;EACE,mBAAmB;CACpB;AACD;EACE,iBAAiB;CAClB",file:"InfoList.vue",sourcesContent:["\n.school-item {\r\n  margin-bottom: 1px;\n}\n.school-name {\r\n  font-weight: 700;\n}\r\n"],sourceRoot:""}])}});
//# sourceMappingURL=7.d19ad4862aecc311ce48.js.map