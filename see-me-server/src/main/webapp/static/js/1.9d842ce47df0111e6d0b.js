webpackJsonp([1],{"1N5e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),o=i("Y81h"),r=i.n(o),l=i("q4js"),s=i("eOoE"),c={data:function(){return{query:{title:"",createField:""},addEditDialogVisible:!1,isEdit:!1,isShowImgPreview:!1,previewImageUrl:"",page:{pageNumber:1,pageSize:10,total:0},fieldList:[],cover:"",linkImageList:[],extImageList:[],infoForm:{title:"",cover:"",extCoverList:[],content:""},rules:{title:[{required:!0,message:"请输入资讯标题",trigger:"blur"}],cover:[{required:!0,message:"请上传封面",trigger:"change"}],createFieldId:[{required:!0,message:"请选择展示领域",trigger:"change"}],content:[{required:!0,message:"请输入正文",trigger:"blur"},{min:20,message:"长度不能少于20个字符",trigger:"blur"}]},tableData:[]}},computed:{realIndex:function(){var e=this;return function(t){return(e.page.pageNumber-1)*e.page.pageSize+t+1}},statusName:function(){return function(e){return["草稿","进行中","过期"][e]}},headers:function(){return{jxtAdminSessionId:this.$store.state.token}}},methods:{closeDialog:function(e){this[e]=!1,this.infoForm={title:"",cover:"",extCoverList:[],content:""},this.$refs.upload.clearFiles(),this.$refs.infoForm&&this.$refs.infoForm.resetFields()},handleSizeChange:function(e){this.page.pageSize=e,this.getList()},handleCoverCardPreview:function(e){this.previewImageUrl=e,this.isShowImgPreview=!0},handleCurrentChange:function(e){this.pageNumber=e,this.getList()},formatDate:function(){return this.$moment(arguments.length<=2?void 0:arguments[2]).format("YYYY-MM-DD")},handleSearch:function(){this.getList()},handleAdd:function(){this.isEdit=!1,this.cover="",this.extCoverList=[],this.linkImageList=[],this.addEditDialogVisible=!0},handleEdit:function(e,t){this.cover="",this.extImageList=[],this.linkImageList=[],this.isEdit=!0,this.reFindDetailByid(t.id),this.addEditDialogVisible=!0},reFindDetailByid:function(e){var t=this;(function(e){return Object(s.a)({url:"/admin/info/information/findById",method:"post",data:e})})({id:e}).then(function(e){t.infoForm=e.data,t.cover=t.infoForm.cover,t.infoForm.imagesPath&&t.infoForm.imagesPath.split(",").forEach(function(e){t.extImageList.push({url:e}),t.linkImageList.push({url:e})})})},handlePictureCardPreview:function(e){this.previewImageUrl=e.url,this.isShowImgPreview=!0},handleExtCoverSuccess:function(e){this.linkImageList.push(e.file)},handleExtCoverRemove:function(e){var t=0;e.response?(t=this.linkImageList.findIndex(function(t){return t.name===e.response.file.name}),this.linkImageList.splice(t,1)):(t=this.linkImageList.findIndex(function(t){return t.uid===e.uid}),this.linkImageList.splice(t,1))},handleCoverRemove:function(e,t){this.infoForm.cover=""},handleCoverSuccess:function(e,t){this.cover=e.file.url,this.infoForm.cover=e.file.url},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png",i=e.size/1024/1024<2;return t||this.$message.error("上传图片只能是 JPG或者 png 格式!"),i||this.$message.error("上传图片大小不能超过 2MB!"),t&&i},handleImageAdded:function(e,t,i){Object(l.a)(e,"/upload").then(function(e){var a=e.data.file.url;-1===a.indexOf("http")&&(a="http://127.0.0.1:80"+a),t.insertEmbed(i,"image",a)}).catch(function(e){console.log(e)})},handleSubmitSave:function(){var e=this;this.$refs.infoForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start(),e.infoForm.imagesPath=e.linkImageList.map(function(e){return e.url}).join(",");(function(e){return Object(s.a)({url:"/admin/info/information/save",method:"post",data:e})})(n()({},e.infoForm)).then(function(t){r.a.done(),e.$message.success(t.data.msg),e.$refs.infoForm.resetFields(),e.addEditDialogVisible=!1,e.getList()})})})},handleSubmitUpdate:function(){var e=this;this.$refs.infoForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start(),e.infoForm.imagesPath=e.linkImageList.map(function(e){return e.url}).join(",");(function(e){return Object(s.a)({url:"/admin/info/information/update",method:"post",data:e})})(n()({},e.infoForm)).then(function(t){r.a.done(),e.$message.success(t.data.msg),e.$refs.infoForm.resetFields(),e.addEditDialogVisible=!1,e.getList()})})})},handleRemove:function(e,t){var i=this;this.$confirm("确定删除吗？").then(function(e){(function(e){return Object(s.a)({url:"/admin/info/information/remove/"+e,method:"get"})})(t.id).then(function(e){i.$message.success(e.data.msg),i.getList()}).catch(function(e){i.$message.error(e)})}).catch(function(e){})},getList:function(){var e=this;(function(e){return Object(s.a)({url:"/admin/info/information/list",method:"post",data:e})})({title:this.query.title,fieldId:this.query.createField,pageNumber:this.page.pageNumber,pageSize:this.page.pageSize}).then(function(t){e.tableData=t.data.page.list,e.page.total=t.data.page.totalRow}).catch(function(t){e.$message.error(t),console.log(t)})},reFindCreateFieldList:function(){var e=this;Object(s.a)({url:"/admin/user/project/findCreateFileldList",method:"get"}).then(function(t){e.fieldList=t.data,console.log("参数",e.fieldList)})}},mounted:function(){this.getList(),this.reFindCreateFieldList()}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{staticClass:"query-form",attrs:{inline:"",model:e.query,"label-position":"right","label-width":"70px"}},[i("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入资讯名称"},model:{value:e.query.title,callback:function(t){e.$set(e.query,"title",t)},expression:"query.title"}}),e._v(" "),i("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",placeholder:"请选择展示领域"},model:{value:e.query.createField,callback:function(t){e.$set(e.query,"createField",t)},expression:"query.createField"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.id,attrs:{label:e.fieldName,value:e.id}})})),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("添加资讯")])],1)],1),e._v(" "),i("el-table",{staticClass:"table",attrs:{data:e.tableData,"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},stripe:"",border:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",index:e.realIndex,width:"70"}}),e._v(" "),i("el-table-column",{attrs:{prop:"cover",label:"封面图",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("img",{staticStyle:{width:"30px",height:"30px",cursor:"pointer"},attrs:{src:t.row.cover},on:{click:function(i){e.handleCoverCardPreview(t.row.cover)}}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"资讯标题"}}),e._v(" "),i("el-table-column",{attrs:{prop:"adminName",label:"咨询发布人"}}),e._v(" "),i("el-table-column",{attrs:{prop:"readCount",label:"阅读量"}}),e._v(" "),i("el-table-column",{attrs:{prop:"fieldName",label:"展示领域"}}),e._v(" "),i("el-table-column",{attrs:{prop:"createDate",sortable:"",label:"创建时间",formatter:e.formatDate}}),e._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.statusName(t.row.status)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(i){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(i){e.handleRemove(t.$index,t.row)}}},[e._v("刪除")])]}}])})],1),e._v(" "),i("el-pagination",{staticClass:"table__pagination",attrs:{background:"","current-page":e.page.pageNumber,"page-sizes":[10,20,30,40],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("el-dialog",{attrs:{top:"0",title:e.isEdit?"编辑":"新增",visible:e.addEditDialogVisible,width:"900px"},on:{"update:visible":function(t){e.addEditDialogVisible=t},close:function(t){e.closeDialog("addEditDialogVisible")}}},[i("el-form",{ref:"infoForm",staticStyle:{"margin-top":"-20px"},attrs:{inline:"",model:e.infoForm,rules:e.rules,"label-width":"120px"}},[i("div",{staticClass:"form__title"},[e._v("基本信息")]),e._v(" "),i("div",{staticStyle:{position:"relative"}},[i("el-form-item",{staticStyle:{display:"block"},attrs:{prop:"title",label:"标题："}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标题"},model:{value:e.infoForm.title,callback:function(t){e.$set(e.infoForm,"title",t)},expression:"infoForm.title"}})],1),e._v(" "),i("el-form-item",{staticStyle:{display:"block"},attrs:{prop:"createField",label:"展示领域："}},[i("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",placeholder:"请选择创作领域"},model:{value:e.infoForm.fieldId,callback:function(t){e.$set(e.infoForm,"fieldId",t)},expression:"infoForm.fieldId"}},e._l(e.fieldList,function(e){return i("el-option",{key:e.id,attrs:{label:e.fieldName,value:e.id}})}))],1),e._v(" "),i("el-form-item",{staticStyle:{display:"block"},attrs:{prop:"status",label:"状态："}},[i("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择状态"},model:{value:e.infoForm.status,callback:function(t){e.$set(e.infoForm,"status",t)},expression:"infoForm.status"}},[i("el-option",{key:0,attrs:{label:"草稿",value:0}}),e._v(" "),i("el-option",{key:1,attrs:{label:"进行中",value:1}}),e._v(" "),i("el-option",{key:2,attrs:{label:"过期",value:2}})],1)],1),e._v(" "),i("el-form-item",{staticStyle:{position:"absolute",right:"30px",top:"0"},attrs:{prop:"cover",label:"封面："}},[i("el-upload",{staticClass:"img-uploader",staticStyle:{width:"165px",height:"165px"},attrs:{action:"/upload",headers:e.headers,"show-file-list":!1,"on-success":e.handleCoverSuccess,"on-remove":e.handleCoverRemove,"before-upload":e.beforeAvatarUpload}},[e.cover?i("img",{staticClass:"img",staticStyle:{"max-width":"165px",height:"165px"},attrs:{src:e.cover}}):i("i",{staticClass:"el-icon-plus img-uploader-icon",staticStyle:{"max-width":"165px",height:"165px"}})])],1)],1),e._v(" "),i("div",{staticClass:"form__title"},[e._v("内容")]),e._v(" "),i("el-form-item",{staticStyle:{display:"block"},attrs:{prop:"extCover",label:"配图："}},[i("el-upload",{ref:"upload",attrs:{action:"/upload","list-type":"picture-card",headers:e.headers,"file-list":e.extImageList,"on-success":e.handleExtCoverSuccess,"on-remove":e.handleExtCoverRemove,"on-preview":e.handlePictureCardPreview,"before-upload":e.beforeAvatarUpload}},[i("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),i("el-form-item",{attrs:{prop:"content",label:"正文"}},[i("vue-editor",{staticStyle:{width:"700px"},attrs:{useCustomImageHandler:""},on:{imageAdded:e.handleImageAdded},model:{value:e.infoForm.content,callback:function(t){e.$set(e.infoForm,"content",t)},expression:"infoForm.content"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{"margin-top":"-35px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.closeDialog("addEditDialogVisible")}}},[e._v("关闭")]),e._v(" "),e.isEdit?i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitUpdate}},[e._v("更新")]):i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitSave}},[e._v("提交")])],1)],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowImgPreview,expression:"isShowImgPreview"}],staticClass:"pircture__preview",on:{click:function(t){e.isShowImgPreview=!1}}},[i("img",{staticClass:"preview__img",attrs:{src:e.previewImageUrl,alt:""}})])],1)},staticRenderFns:[]},u=i("VU/8")(c,d,!1,function(e){i("kLRH")},null,null);t.default=u.exports},fOmc:function(e,t,i){(e.exports=i("FZ+f")(!0)).push([e.i,"\n.form__title {\n  font-size: 25px;\n  font-weight: bold;\n  margin: 0 0 20px 60px;\n}\n","",{version:3,sources:["/Users/eucalyptus-leave/Desktop/personal/see_me/see-me-backend/src/views/info/InfoList.vue"],names:[],mappings:";AACA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,sBAAsB;CACvB",file:"InfoList.vue",sourcesContent:["\n.form__title {\n  font-size: 25px;\n  font-weight: bold;\n  margin: 0 0 20px 60px;\n}\n"],sourceRoot:""}])},kLRH:function(e,t,i){var a=i("fOmc");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("33491b30",a,!0)},q4js:function(e,t,i){"use strict";t.a=function(e,t,i){var a=new FormData;a.append("file",e);var o={headers:{"Content-Type":"multipart/form-data",jxt_admin_session_id:i}};return n.post(t,a,o)};var a=i("OMN4"),n=i.n(a).a.create()}});
//# sourceMappingURL=1.9d842ce47df0111e6d0b.js.map