webpackJsonp([2],{"1N5e":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("woOf"),a=t.n(i),o=t("Y81h"),r=t.n(o),l=t("q4js"),s=t("eOoE"),c={data:function(){return{query:{title:"",createField:""},addEditDialogVisible:!1,isEdit:!1,isShowImgPreview:!1,previewImageUrl:"",page:{pageNumber:1,pageSize:10,total:0},fieldList:[],cover:"",extCoverList:[],infoForm:{title:"",cover:"",extCoverList:[],content:""},rules:{title:[{required:!0,message:"请输入资讯标题",trigger:"blur"}],cover:[{required:!0,message:"请上传封面",trigger:"change"}],createFieldId:[{required:!0,message:"请选择展示领域",trigger:"change"}],content:[{required:!0,message:"请输入正文",trigger:"blur"},{min:20,message:"长度不能少于20个字符",trigger:"blur"}]},tableData:[]}},computed:{statusName:function(){return function(n){return["草稿","进行中","过期"][n]}},headers:function(){return{jxtAdminSessionId:this.$store.state.token}}},methods:{closeDialog:function(){this.addEditDialogVisible=!1,this.$refs.infoForm.resetFields()},handleSizeChange:function(n){this.page.pageSize=n,this.getList()},handleCoverCardPreview:function(n){this.previewImageUrl=n,this.isShowImgPreview=!0},handleCurrentChange:function(n){this.pageNumber=n,this.getList()},formatDate:function(){return this.$moment(arguments.length<=2?void 0:arguments[2]).format("YYYY-MM-DD")},handleSearch:function(){this.getList()},handleAdd:function(){this.isEdit=!1,this.cover="",this.extCoverList=[],this.infoForm=a()({},null),this.addEditDialogVisible=!0},handleEdit:function(n,e){this.cover="",this.extImageList=[],this.isEdit=!0,this.reFindDetailByid(e.id),this.addEditDialogVisible=!0},reFindDetailByid:function(n){var e=this;(function(n){return Object(s.a)({url:"/admin/info/information/findById",method:"post",data:n})})({id:n}).then(function(n){e.infoForm=n.data,e.cover=e.infoForm.cover,e.infoForm.imagesPath&&e.infoForm.imagesPath.split(",").forEach(function(n){e.extImageList.push({url:n})})})},handlePictureCardPreview:function(n){this.previewImageUrl=n.url,this.isShowImgPreview=!0},handleExtCoverSuccess:function(n,e){this.extImageList.push(n.file)},handleCoverRemove:function(n,e){this.infoForm.cover=""},handleCoverSuccess:function(n,e){this.cover=n.file.url,this.infoForm.cover=n.file.url},beforeAvatarUpload:function(n){var e="image/jpeg"===n.type||"image/png",t=n.size/1024/1024<2;return e||this.$message.error("上传图片只能是 JPG或者 png 格式!"),t||this.$message.error("上传图片大小不能超过 2MB!"),e&&t},handleImageAdded:function(n,e,t){Object(l.a)(n,"/admin/upload").then(function(n){var i=n.data.file.url;-1===i.indexOf("http")&&(i="http://127.0.0.1:80"+i),e.insertEmbed(t,"image",i)}).catch(function(n){console.log(n)})},handleSubmitSave:function(){var n=this;this.$refs.infoForm.validate(function(e){e&&n.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start(),n.infoForm.imagesPath=n.extImageList.join(",");(function(n){return Object(s.a)({url:"/admin/info/information/save",method:"post",data:n})})(a()({},n.infoForm)).then(function(e){r.a.done(),n.$message.success(e.data.msg),n.$refs.infoForm.resetFields(),n.addEditDialogVisible=!1,n.getList()})})})},handleSubmitUpdate:function(){var n=this;this.$refs.infoForm.validate(function(e){e&&n.$confirm("确认提交吗？","提示",{}).then(function(){r.a.start(),n.infoForm.imagesPath=n.extImageList.join(",");(function(n){return Object(s.a)({url:"/admin/info/information/update",method:"post",data:n})})(a()({},n.infoForm)).then(function(e){r.a.done(),n.$message.success(e.data.msg),n.$refs.infoForm.resetFields(),n.addEditDialogVisible=!1,n.getList()})})})},handleRemove:function(n,e){var t=this;this.$confirm("确定删除吗？").then(function(n){(function(n){return Object(s.a)({url:"/admin/info/information/remove/"+n,method:"get"})})(e.id).then(function(n){t.$message.success(n.data.msg),t.getList()}).catch(function(n){t.$message.error(n)})}).catch(function(n){})},getList:function(){var n=this;(function(n){return Object(s.a)({url:"/admin/info/information/list",method:"post",data:n})})({title:this.query.title,author:this.query.author,pageNumber:this.page.pageNumber,pageSize:this.page.pageSize}).then(function(e){n.tableData=e.data.page.list,n.page.total=e.data.page.totalRow}).catch(function(e){n.$message.error(e),console.log(e)})},reFindCreateFieldList:function(){var n=this;Object(s.a)({url:"/admin/user/project/findCreateFileldList",method:"get"}).then(function(e){n.fieldList=e.data,console.log("参数",n.fieldList)})}},mounted:function(){this.getList(),this.reFindCreateFieldList()}},d={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",[t("el-form",{staticClass:"query-form",attrs:{inline:"",model:n.query,"label-position":"right","label-width":"70px"}},[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入资讯名称"},model:{value:n.query.title,callback:function(e){n.$set(n.query,"title",e)},expression:"query.title"}}),n._v(" "),t("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",placeholder:"请选择展示领域"},model:{value:n.query.createField,callback:function(e){n.$set(n.query,"createField",e)},expression:"query.createField"}},n._l(n.fieldList,function(n){return t("el-option",{key:n.id,attrs:{label:n.fieldName,value:n.id}})})),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:n.handleSearch}},[n._v("搜索")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:n.handleAdd}},[n._v("添加资讯")])],1)],1),n._v(" "),t("el-table",{staticClass:"table",attrs:{data:n.tableData,"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},stripe:"",border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"70"}}),n._v(" "),t("el-table-column",{attrs:{prop:"cover",label:"封面图",width:"100"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("img",{staticStyle:{width:"30px",height:"30px",cursor:"pointer"},attrs:{src:e.row.cover},on:{click:function(t){n.handleCoverCardPreview(e.row.cover)}}})]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"title",label:"资讯标题"}}),n._v(" "),t("el-table-column",{attrs:{prop:"adminName",label:"咨询发布人"}}),n._v(" "),t("el-table-column",{attrs:{prop:"readCount",label:"阅读量"}}),n._v(" "),t("el-table-column",{attrs:{prop:"fieldName",label:"展示领域"}}),n._v(" "),t("el-table-column",{attrs:{prop:"createDate",sortable:"",label:"创建时间",formatter:n.formatDate}}),n._v(" "),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(n.statusName(e.row.status)))])]}}])}),n._v(" "),t("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){n.handleEdit(e.$index,e.row)}}},[n._v("编辑")]),n._v(" "),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){n.handleRemove(e.$index,e.row)}}},[n._v("刪除")])]}}])})],1),n._v(" "),t("el-pagination",{staticClass:"table__pagination",attrs:{background:"","current-page":n.page.pageNumber,"page-sizes":[10,20,30,40],"page-size":n.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:n.page.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}}),n._v(" "),t("el-dialog",{attrs:{top:"2vh",title:n.isEdit?"编辑":"新增",visible:n.addEditDialogVisible,width:"60%"},on:{"update:visible":function(e){n.addEditDialogVisible=e}}},[t("el-form",{ref:"infoForm",attrs:{inline:"",model:n.infoForm,rules:n.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{prop:"title",label:"标题："}},[t("el-input",{attrs:{placeholder:"请输入标题："},model:{value:n.infoForm.title,callback:function(e){n.$set(n.infoForm,"title",e)},expression:"infoForm.title"}})],1),n._v(" "),t("el-form-item",{attrs:{prop:"createField",label:"展示领域："}},[t("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",placeholder:"请选择创作领域"},model:{value:n.infoForm.fieldId,callback:function(e){n.$set(n.infoForm,"fieldId",e)},expression:"infoForm.fieldId"}},n._l(n.fieldList,function(n){return t("el-option",{key:n.id,attrs:{label:n.fieldName,value:n.id}})}))],1),n._v(" "),t("el-form-item",{staticStyle:{width:"400px"},attrs:{prop:"cover",label:"封面："}},[t("el-upload",{staticClass:"img-uploader",attrs:{action:"/admin/upload",headers:n.headers,"show-file-list":!1,"on-success":n.handleCoverSuccess,"on-remove":n.handleCoverRemove,"before-upload":n.beforeAvatarUpload}},[n.cover?t("img",{staticClass:"img",attrs:{src:n.cover}}):t("i",{staticClass:"el-icon-plus img-uploader-icon"})])],1),n._v(" "),t("el-form-item",{staticStyle:{"margin-left":"-80px"},attrs:{prop:"status",label:"状态："}},[t("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择状态"},model:{value:n.infoForm.status,callback:function(e){n.$set(n.infoForm,"status",e)},expression:"infoForm.status"}},[t("el-option",{key:0,attrs:{label:"草稿",value:0}}),n._v(" "),t("el-option",{key:1,attrs:{label:"进行中",value:1}}),n._v(" "),t("el-option",{key:2,attrs:{label:"过期",value:2}})],1)],1),n._v(" "),t("el-form-item",{staticStyle:{display:"block"},attrs:{prop:"extCover",label:"配图："}},[t("el-upload",{attrs:{action:"/admin/upload","list-type":"picture-card",headers:n.headers,"file-list":n.extImageList,"on-success":n.handleExtCoverSuccess,"on-remove":n.handleExtCoverRemove,"on-preview":n.handlePictureCardPreview,"before-upload":n.beforeAvatarUpload}},[t("i",{staticClass:"el-icon-plus"})])],1),n._v(" "),t("el-form-item",{attrs:{prop:"content",label:"正文"}},[t("vue-editor",{attrs:{useCustomImageHandler:""},on:{imageAdded:n.handleImageAdded},model:{value:n.infoForm.content,callback:function(e){n.$set(n.infoForm,"content",e)},expression:"infoForm.content"}})],1)],1),n._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:n.closeDialog}},[n._v("关闭")]),n._v(" "),n.isEdit?t("el-button",{attrs:{type:"primary"},on:{click:n.handleSubmitUpdate}},[n._v("更新")]):t("el-button",{attrs:{type:"primary"},on:{click:n.handleSubmitSave}},[n._v("提交")])],1)],1),n._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowImgPreview,expression:"isShowImgPreview"}],staticClass:"pircture__preview",on:{click:function(e){n.isShowImgPreview=!1}}},[t("img",{staticClass:"preview__img",attrs:{src:n.previewImageUrl,alt:""}})])],1)},staticRenderFns:[]},u=t("VU/8")(c,d,!1,function(n){t("Bpef")},null,null);e.default=u.exports},Bpef:function(n,e,t){var i=t("IouH");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("rjj0")("727c70ca",i,!0)},IouH:function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"InfoList.vue",sourceRoot:""}])},q4js:function(n,e,t){"use strict";e.a=function(n,e,t){var i=new FormData;i.append("file",n);var o={headers:{"Content-Type":"multipart/form-data",jxt_admin_session_id:t}};return a.post(e,i,o)};var i=t("OMN4"),a=t.n(i).a.create()}});
//# sourceMappingURL=2.96e5988c3cea43056f34.js.map